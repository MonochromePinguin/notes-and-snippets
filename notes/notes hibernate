● objets notables :
• SessionFactory :
	abstraction de la BdD
• Session :
	abstraction de la connexion à la BdD
• Transation :
	session.beginTransaction()

• TransactionFactory :
	optionnel.
•

• JTA « Java Transaction API » :
protocole de commit à 2 phases, très efficace pour transactions courtes,
mais lourd pour grosses transactions.
→ 2 commits à réaliser :
_ le 1er verrouille la table,
_ le 2e commit le tout.


● CLASSES PERSISTANTES :
_ classes sauvées en BdD.
• bonnes pratiques :
_ classes POJO (« Plain Old Java Object ») :
simples classes,
	_ avec constructeur par défaut (« sans paramètres »),
	_ propriétés persistées privées avec getters/setters


● JPA :
« Java Persistance API », sur laquelle  Hibernate est basée.
• par convention, informations sur la couche de persistance stockées dans
    META-INF/persistence.xml

• démarche par défaut :
	EntityManagerFactory emf = createEntityManagerFactory("nomTable");
	EntityManager em = emf.createEntityManager();
	EntityTransaction tx = em.getTransaction();
	tx.begin();
	em.persist(objetÀpersister);
	tx.commit();
  
• méthodes liées aux objets persistants :
	new()
	.refresh() (utile en cas d'accès concurents)
	.remove()   → retire l'objet du la gestion par le JPA ET de la BdD
	.persist()  

    
● ANNOTATIONS JPA :
• classes :
	@Entity     →   persistance
	@Table(name = "table", schema = "BdD" [, catalog = ""] )
• colonnes :
	@Id
	@Generatedalue
	
	@Column(name = "col")
	@Column(name="colonne", unique = true, nullable = false)
    @Column(length = 𝑛)

● config XML :
<class name="FQCN" table="TABLE">
	<id name="id" type="java.lang.Long">
		<column name="REVS_ID" />
		<generator class="sequence">
			<param name="sequence">SEQ_REVS_ID</param>
		</generator>
	</id>

	<property name="date" type="java.util.Date">
		<column name="REVS_DATE" />
	</property>

	<set name="realizedErasedSimultaneousVolumeValues" cascade="all" order-by="REVSV_ID">
		<key column="REVS_ID" not-null="true" />
		<one-to-many
			class="com.bla.RealizedErasedSimultaneousVolumeValue" />
	</set>

	<one-to-one name="calculationProgress"
		class="com.rte.crema.dao.calculationprogress.entity.CalculationProgress"
		foreign-key="CAL_ID"
		constrained="true"		#s'assure que l'entité cible existe 
		cascade="save-update"
		lazy="false" fetch="select" />


</class>


● HQL :
    Query query = session.createQuery("FROM table");
    List<Obj> list = query.list();



● différences d'implémentation entre couches JPA et Hibernate :
• standard JPA :
    TransactionManager → EntityManager → PersistenceUnit → DataSource
• Hibernate :                   |       /
    TransactionManager →     SessionManager → DataSource 


● hibernate.cfg.xml :
	Doit faire le lien avec les classes utilisées via des entrées «mapping»
	
• DÉBOGUAGE - afficher les requêtes SQL exécutées par hibernate :

<hibernate-configuration>
	<session-factory>
		...
		<!-- Echo all executed SQL to stdout -->
		<property name="show_sql">false</property>
		<property name="format_sql">false</property>
		...
		
